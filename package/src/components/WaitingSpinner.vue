<script setup="props" lang="ts">
  // Using the Vue component with requestAnimationFrame
  // allows reduce the CPU usage compared to pure dynamic SVG
  const props = withDefaults(
    defineProps<{
      size?: number,
      visible?: boolean,
    }>(), {
      size: 32,
      visible: false,
    }
  )

  let index = ref(1)
  let started = ref(false)
  let requestId = ref(0)

  const spine = (t: number) => {
    index.value = Math.floor(t / 125) % 8
    started.value = true
    requestId.value = requestAnimationFrame(spine)
  }

  requestId.value = requestAnimationFrame(spine)

  onUnmounted(() => {
    cancelAnimationFrame(requestId.value)
  })

</script>
<template>
  <svg
    v-if="props.visible && started"
    viewBox="0 0 58 58"
    xmlns="http://www.w3.org/2000/svg"
    :height="props.size + 'px'"
    :width="props.size + 'px'"
    fill="currentColor">
    <path
      v-show="index !== 0"
      d="m 29.000004,0.06975298 c 1.58458,0 2.860254,1.51370482 2.860254,3.39395692 V 14.844156 c 0,1.880252 -1.275674,3.393957 -2.860254,3.393957 -1.584581,0 -2.860254,-1.513705 -2.860254,-3.393957 V 3.4637099 c 0,-1.8802521 1.275673,-3.39395692 2.860254,-3.39395692 z">
    </path>
    <path
      v-show="index !== 1"
      d="m 49.456778,8.5432261 c 1.120467,1.1204673 0.952154,3.0928559 -0.377385,4.4223949 l -8.047191,8.047191 c -1.329539,1.329539 -3.301927,1.497852 -4.422395,0.377385 -1.120468,-1.120468 -0.952154,-3.092856 0.377385,-4.422395 l 8.047191,-8.0471909 c 1.329539,-1.329539 3.301927,-1.4978529 4.422395,-0.377385 z">
    </path>
    <path
      v-show="index !== 2"
      d="m 57.930252,29 c -1e-6,1.58458 -1.513705,2.860254 -3.393957,2.860254 H 43.155848 c -1.880252,0 -3.393956,-1.275674 -3.393957,-2.860254 0,-1.584581 1.513705,-2.860254 3.393957,-2.860254 h 11.380447 c 1.880252,0 3.393956,1.275673 3.393957,2.860254 z">
    </path>
    <path
      v-show="index !== 3"
      d="m 49.456779,49.456774 c -1.120468,1.120467 -3.092856,0.952154 -4.422395,-0.377385 l -8.047192,-8.047191 c -1.329539,-1.329539 -1.497851,-3.301927 -0.377385,-4.422395 1.120468,-1.120468 3.092856,-0.952154 4.422395,0.377385 l 8.047192,8.047191 c 1.329539,1.329539 1.497852,3.301927 0.377385,4.422395 z">
    </path>
    <path
      v-show="index !== 4"
      d="m 29.000005,57.930248 c -1.58458,-10e-7 -2.860254,-1.513705 -2.860254,-3.393957 l -1e-6,-11.380447 c 0,-1.880253 1.275675,-3.393956 2.860254,-3.393957 1.584581,0 2.860254,1.513704 2.860254,3.393957 l 10e-7,11.380447 c 0,1.880252 -1.275674,3.393956 -2.860254,3.393957 z">
    </path>
    <path
      v-show="index !== 5"
      d="M 8.5432307,49.456775 C 7.4227641,48.336307 7.5910767,46.363919 8.9206157,45.03438 l 8.0471903,-8.047192 c 1.32954,-1.32954 3.301928,-1.497851 4.422395,-0.377385 1.120468,1.120468 0.952155,3.092855 -0.377385,4.422395 l -8.04719,8.047192 c -1.329539,1.329539 -3.3019274,1.497852 -4.4223953,0.377385 z">
    </path>
    <path
      v-show="index !== 6"
      d="m 0.06975667,29.000001 c 9.9e-7,-1.58458 1.51370493,-2.860254 3.39395703,-2.860254 l 11.3804473,-1e-6 c 1.880253,0 3.393956,1.275675 3.393957,2.860254 0,1.584581 -1.513704,2.860254 -3.393957,2.860254 l -11.3804471,10e-7 c -1.8802521,0 -3.39395659,-1.275674 -3.39395723,-2.860254 z" >
    </path>
    <path
      v-show="index !== 7"
      d="M 8.5432297,8.5432265 C 9.6636976,7.42276 11.636086,7.5910726 12.965625,8.9206116 l 8.047192,8.0471904 c 1.32954,1.32954 1.497851,3.301928 0.377385,4.422395 -1.120468,1.120468 -3.092855,0.952155 -4.422395,-0.377385 L 8.9206148,12.965622 C 7.5910758,11.636083 7.4227629,9.6636943 8.5432297,8.5432265 Z">
   </path>
  </svg>
</template>
